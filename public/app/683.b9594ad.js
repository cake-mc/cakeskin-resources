(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[683],{1570:function(e,s){s.w=function(e){return e}},5996:function(e,s,i){"use strict";var n=i(5893);i(3804),s.Z=()=>(0,n.jsx)("div",Object.assign({className:"container text-center",title:"Loading..."},{children:(0,n.jsx)("i",{className:"fas fa-sync fa-spin"},void 0)}),void 0)},9147:function(e,s,i){"use strict";i.d(s,{Z:function(){return c}});var n=i(5893),t=(i(3804),i(88)),a=e=>{const s=["page-item"];return e.active&&s.push("active"),e.disabled&&s.push("disabled"),e.className&&s.push(e.className),(0,n.jsx)("li",Object.assign({className:s.join(" "),title:e.title,onClick:s=>{s.preventDefault(),!e.disabled&&e.onClick&&e.onClick()}},{children:(0,n.jsx)("a",Object.assign({href:"#",className:"page-link","aria-disabled":e.disabled},{children:e.children}),void 0)}),void 0)};var c=e=>{const{page:s,totalPages:i,onChange:c}=e;return i<1?null:(0,n.jsxs)("ul",Object.assign({className:"pagination"},{children:[(0,n.jsxs)(a,Object.assign({title:(0,t.t)("vendor.datatable.prev"),disabled:1===s,onClick:()=>c(s-1)},{children:["‹",(0,n.jsx)("span",Object.assign({className:"d-inline d-sm-none ml-1"},{children:(0,t.t)("vendor.datatable.prev")}),void 0)]}),void 0),i<8?Array.from({length:i}).map(((e,i)=>(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",active:s===i+1,onClick:()=>c(i+1)},{children:i+1}),i))):(0,n.jsxs)(n.Fragment,{children:[s<4?[1,2,3,4].map((e=>(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",active:s===e,onClick:()=>c(e)},{children:e}),e))):(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",onClick:()=>c(1)},{children:"1"}),void 0),(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",disabled:!0},{children:"..."}),void 0),s>3&&s<i-2&&(0,n.jsxs)(n.Fragment,{children:[[s-1,s,s+1].map((e=>(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",active:s===e,onClick:()=>c(e)},{children:e}),e))),(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",disabled:!0},{children:"..."}),void 0)]},void 0),i-s<3?[i-3,i-2,i-1,i].map((e=>(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",active:s===e,onClick:()=>c(e)},{children:e}),e))):(0,n.jsx)(a,Object.assign({className:"d-none d-sm-block",onClick:()=>c(i)},{children:i}),void 0)]},void 0),(0,n.jsxs)(a,Object.assign({title:(0,t.t)("vendor.datatable.next"),disabled:s===i,onClick:()=>c(s+1)},{children:[(0,n.jsx)("span",Object.assign({className:"d-inline d-sm-none mr-1"},{children:(0,t.t)("vendor.datatable.next")}),void 0),"›"]}),void 0)]}),void 0)}},9341:function(e,s,i){"use strict";i.d(s,{Z:function(){return t}});var n=i(3804);function t(e,s){const[i,t]=(0,n.useState)(s);return(0,n.useEffect)((()=>{t(blessing.extra[e])}),[]),i}},9018:function(e,s,i){"use strict";i.d(s,{Z:function(){return a}});var n=i(3804),t=i(3601);function a(){(0,n.useEffect)((()=>{(0,t.j)("mounted")}),[])}},7109:function(e,s,i){"use strict";var n,t;i.d(s,{P:function(){return n},N:function(){return t}}),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(n||(n={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(t||(t={}))},6051:function(e,s,i){"use strict";i.d(s,{G:function(){return t},b:function(){return a}});var n=i(917);const t=n.iv`
  cursor: pointer;
`,a=n.iv`
  display: flex;
  justify-content: center;
  align-items: center;
`},7920:function(e,s,i){"use strict";i.d(s,{Z:function(){return d}});var n=i(88),t=i(6703),a=i(439),c=i(8848);async function d(e){let s;try{const{value:i}=await(0,a.K)({mode:"prompt",title:(0,n.t)("skinlib.setItemName"),text:(0,n.t)("skinlib.applyNotice"),input:e.name,validator:e=>{if(!e)return(0,n.t)("skinlib.emptyItemName")}});s=i}catch(e){return!1}const{code:i,message:d}=await t.v_(c.Z.user.closet.add(),{tid:e.tid,name:s});return 0===i?a.A.success(d):a.A.error(d),0===i}},5683:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return S}});var n=i(5893),t=i(3804),a=i(1570),c=i(9341),d=i(9018),l=i(88),o=i(6703),r=i(439),v=i(7109),u=i(8848),b=i(5996),m=i(9147),j=i(7920),g=i(5667),p=e=>{var s;const i=[null!==(s=e.className)&&void 0!==s?s:""];e.bg&&i.push("btn",`bg-${e.bg}`),e.active&&i.push("active");const t=Object.assign(Object.assign({},e),{active:void 0,bg:void 0});return(0,n.jsx)("button",Object.assign({},t,{className:i.join(" ")},{children:e.children}),void 0)};function h(e){switch(e){case v.N.Steve:return"Steve";case v.N.Alex:return"Alex";default:return(0,l.t)(`general.${e}`)}}var x=e=>{const{filter:s,onChange:i}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",Object.assign({className:"btn btn-default dropdown-toggle",type:"button","data-toggle":"dropdown"},{children:h(s)}),void 0),(0,n.jsxs)("div",Object.assign({className:"dropdown-menu"},{children:[(0,n.jsx)(p,Object.assign({className:"dropdown-item",active:"skin"===s,onClick:()=>i("skin")},{children:(0,l.t)("general.skin")}),void 0),(0,n.jsx)(p,Object.assign({className:"dropdown-item",active:s===v.N.Steve,onClick:()=>i(v.N.Steve)},{children:"Steve"}),void 0),(0,n.jsx)(p,Object.assign({className:"dropdown-item",active:s===v.N.Alex,onClick:()=>i(v.N.Alex)},{children:"Alex"}),void 0),(0,n.jsx)(p,Object.assign({className:"dropdown-item",active:s===v.N.Cape,onClick:()=>i(v.N.Cape)},{children:(0,l.t)("general.cape")}),void 0)]}),void 0)]},void 0)},f=i(574),k=i(6051);const N=f.Z.div`
  width: 245px;
  transition-property: box-shadow;
  transition-duration: 0.3s;
  &:hover {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
  }

  .card-body {
    background-color: #eff1f0;
  }

  img {
    height: 210px;
  }
`,O=f.Z.span`
  padding-top: 0.4rem;
`,w=(0,f.Z)(O)`
  ${k.G}
  max-width: 100px;
`,C=f.Z.a`
  ${k.G}

  i, span {
    color: ${e=>e.liked?"#dc3545":"#6c757d"};
    &:hover {
      color: ${e=>e.liked?"#dc3545":"#343a40"};
    }
  }
`;var y=e=>{const{item:s}=e,i=`${blessing.base_url}/skinlib/show/${s.tid}`,t=`${blessing.base_url}/preview/${s.tid}?height=150`;return(0,n.jsx)("div",Object.assign({className:"ml-3 mr-2 mb-2"},{children:(0,n.jsxs)(N,Object.assign({className:"card"},{children:[(0,n.jsxs)("div",Object.assign({className:"card-body"},{children:[s.public||(0,n.jsx)("div",Object.assign({className:"ribbon-wrapper"},{children:(0,n.jsx)("div",Object.assign({className:"ribbon bg-pink"},{children:(0,l.t)("skinlib.private")}),void 0)}),void 0),(0,n.jsx)("a",Object.assign({href:i,target:"_blank"},{children:(0,n.jsx)("img",{src:t,alt:s.name,className:"card-img-top"},void 0)}),void 0)]}),void 0),(0,n.jsxs)("div",Object.assign({className:"card-footer"},{children:[(0,n.jsx)("a",Object.assign({className:"d-block mb-1 text-truncate",title:s.name,href:i,target:"_blank"},{children:s.name}),void 0),(0,n.jsxs)("div",Object.assign({className:"d-flex justify-content-between"},{children:[(0,n.jsxs)("div",Object.assign({className:"d-flex"},{children:[(0,n.jsx)(O,Object.assign({className:"badge bg-teal mr-1"},{children:h(s.type)}),void 0),(0,n.jsx)(w,Object.assign({className:"badge bg-indigo text-truncate",title:(0,l.t)("skinlib.show.uploader"),onClick:i=>{i.preventDefault(),e.onUploaderClick(s.uploader)}},{children:s.nickname}),void 0)]}),void 0),(0,n.jsxs)(C,Object.assign({liked:e.liked,tabIndex:-1,onClick:()=>{e.liked?e.onRemove(s):e.onAdd(s)}},{children:[(0,n.jsx)("i",{className:"fas fa-heart mr-1"},void 0),(0,n.jsx)("span",{children:s.likes},void 0)]}),void 0)]}),void 0)]}),void 0)]}),void 0)}),void 0)},S=(0,a.w)((()=>{const[e,s]=(0,t.useState)(!0),[i,a]=(0,t.useState)([]),[h,f]=(0,t.useState)([]),[k,N]=(0,t.useState)("skin"),[O,w]=(0,t.useState)(""),[C,S]=(0,t.useState)(""),[Z,A]=(0,t.useState)(0),[$,U]=(0,t.useState)("time"),[_,E]=(0,t.useState)(1),[I,F]=(0,t.useState)(1),R=(0,c.Z)("currentUid",null);(0,d.Z)(),(0,t.useEffect)((()=>{const e=e=>{var s,i,n,t,a;const c=new URLSearchParams(e),d=null!==(s=c.get("filter"))&&void 0!==s?s:"";N(["skin",v.N.Steve,v.N.Alex,v.N.Cape].includes(d)?d:"skin");const l=decodeURIComponent(null!==(i=c.get("keyword"))&&void 0!==i?i:"");w(l),S(l);const o=null!==(n=c.get("uploader"))&&void 0!==n?n:"0";A(Number.parseInt(o)),U(null!==(t=c.get("sort"))&&void 0!==t?t:"time"),E(Number.parseInt(null!==(a=c.get("page"))&&void 0!==a?a:"1"))};e(location.search);const s=s=>e(s.state);return window.addEventListener("popstate",s),()=>{window.removeEventListener("popstate",s)}}),[]),(0,t.useEffect)((()=>{(async()=>{s(!0);const e=new URLSearchParams;e.append("filter",k),C&&e.append("keyword",C),Z&&e.append("uploader",Z.toString()),e.append("sort",$),e.append("page",_.toString()),window.history.pushState(e.toString(),"",`?${e}`);const i=await o.U2(u.Z.skinlib.list(),e);a(i.data),F(i.last_page),s(!1)})()}),[k,C,Z,$,_]),(0,t.useEffect)((()=>{R&&(async()=>{const e=await o.U2(u.Z.user.closet.ids());f(e)})()}),[R]);const L=e=>A(e);return(0,n.jsxs)("div",Object.assign({className:"container"},{children:[(0,n.jsx)("div",Object.assign({className:"content-header"},{children:(0,n.jsxs)("div",Object.assign({className:"container-fluid d-flex justify-content-between"},{children:[(0,n.jsx)("h1",{children:(0,l.t)("general.skinlib")},void 0),(0,n.jsx)("span",{children:Z?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("i",{className:"fas fa-user mr-1"},void 0),(0,l.t)("skinlib.filter.uploader",{uid:Z})]},void 0):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("i",{className:"fas fa-user-friends mr-1"},void 0),(0,l.t)("skinlib.filter.allUsers")]},void 0)},void 0)]}),void 0)}),void 0),(0,n.jsx)("section",Object.assign({className:"content"},{children:(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsxs)("div",Object.assign({className:"card-body"},{children:[(0,n.jsxs)("div",Object.assign({className:"form-group pt-0 mb-3 d-flex justify-content-between"},{children:[(0,n.jsx)("form",Object.assign({onSubmit:e=>{e.preventDefault(),S(O)}},{children:(0,n.jsxs)("div",Object.assign({className:"input-group"},{children:[(0,n.jsx)("div",Object.assign({className:"input-group-prepend"},{children:(0,n.jsx)(x,{filter:k,onChange:e=>N(e)},void 0)}),void 0),(0,n.jsx)("input",{type:"text",inputMode:"search",className:"form-control",value:O,placeholder:(0,l.t)("vendor.datatable.search"),onChange:e=>{w(e.target.value)}},void 0),(0,n.jsx)("div",Object.assign({className:"input-group-append"},{children:(0,n.jsx)("button",Object.assign({className:"btn btn-primary px-3",type:"submit",title:(0,l.t)("vendor.datatable.search")},{children:(0,n.jsx)("i",{className:"fas fa-search"},void 0)}),void 0)}),void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:"d-none d-sm-block"},{children:(0,n.jsxs)("div",Object.assign({className:"btn-group"},{children:[(0,n.jsx)(p,Object.assign({bg:"olive",active:"likes"===$,onClick:()=>U("likes")},{children:(0,l.t)("skinlib.sort.likes")}),void 0),(0,n.jsx)(p,Object.assign({bg:"olive",active:"time"===$,onClick:()=>U("time")},{children:(0,l.t)("skinlib.sort.time")}),void 0),null!==R&&(0,n.jsx)(p,Object.assign({bg:"olive",active:Z===R,onClick:()=>A(R)},{children:(0,l.t)("skinlib.seeMyUpload")}),void 0),(0,n.jsx)(p,Object.assign({bg:"olive",onClick:()=>{N("skin"),w(""),S(""),U("time"),A(0),E(1)}},{children:(0,l.t)("skinlib.reset")}),void 0)]}),void 0)}),void 0)]}),void 0),i.length>0?(0,n.jsx)("div",Object.assign({className:"d-flex flex-wrap"},{children:i.map(((e,s)=>(0,n.jsx)(y,{item:e,liked:h.includes(e.tid),onAdd:e=>(async(e,s)=>{R?await(0,j.Z)(e)&&(f((s=>[...s,e.tid])),a((i=>(i[s]=Object.assign(Object.assign({},e),{likes:e.likes+1}),i.slice())))):r.A.warning((0,l.t)("skinlib.anonymous"))})(e,s),onRemove:e=>(async(e,s)=>{await(0,g.Z)(e.tid)&&(f((s=>s.filter((s=>s!==e.tid)))),a((i=>(i[s]=Object.assign(Object.assign({},e),{likes:e.likes-1}),i.slice()))))})(e,s),onUploaderClick:L},e.tid)))}),void 0):(0,n.jsx)("p",Object.assign({className:"text-center m-5"},{children:(0,l.t)("general.noResult")}),void 0)]}),void 0),(0,n.jsx)("div",Object.assign({className:"card-footer"},{children:(0,n.jsx)("div",Object.assign({className:"d-flex justify-content-center"},{children:(0,n.jsx)(m.Z,{page:_,totalPages:I,onChange:E},void 0)}),void 0)}),void 0),e&&(0,n.jsx)("div",Object.assign({className:"overlay"},{children:(0,n.jsx)(b.Z,{},void 0)}),void 0)]}),void 0)}),void 0)]}),void 0)}))},5667:function(e,s,i){"use strict";i.d(s,{Z:function(){return d}});var n=i(88),t=i(6703),a=i(439),c=i(8848);async function d(e){try{await(0,a.K)({text:(0,n.t)("user.removeFromClosetNotice"),okButtonType:"danger"})}catch(e){return!1}const{code:s,message:i}=await t.IV(c.Z.user.closet.remove(e));return 0===s?a.A.success(i):a.A.error(i),0===s}}}]);