(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[403],{3291:function(e,s,t){"use strict";var n=t(5893);t(3804),s.Z=e=>(0,n.jsx)("a",Object.assign({href:"#",title:e.title,className:"ml-2",onClick:e.onClick},{children:(0,n.jsx)("i",{className:"fas fa-edit"},void 0)}),void 0)},6309:function(e,s,t){"use strict";var n=t(5893),i=(t(3804),t(88));s.Z=()=>(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("div",Object.assign({className:"d-flex justify-content-between"},{children:(0,n.jsx)("h3",Object.assign({className:"card-title"},{children:(0,n.jsx)("span",{children:(0,i.t)("general.texturePreview")},void 0)}),void 0)}),void 0)}),void 0),(0,n.jsx)("div",{className:"card-body"},void 0)]}),void 0)},9341:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var n=t(3804);function i(e,s){const[t,i]=(0,n.useState)(s);return(0,n.useEffect)((()=>{i(blessing.extra[e])}),[]),t}},9018:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var n=t(3804),i=t(3601);function a(){(0,n.useEffect)((()=>{(0,i.j)("mounted")}),[])}},9683:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var n=t(3804);function i(e){const s=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const t=document.querySelector(e),n=document.createElement("div");return s.current=n,t.appendChild(n),()=>{t.removeChild(n),s.current=null}}),[]),s.current}},7109:function(e,s,t){"use strict";var n,i;t.d(s,{P:function(){return n},N:function(){return i}}),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(n||(n={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(i||(i={}))},6051:function(e,s,t){"use strict";t.d(s,{G:function(){return i},b:function(){return a}});var n=t(917);const i=n.iv`
  cursor: pointer;
`,a=n.iv`
  display: flex;
  justify-content: center;
  align-items: center;
`},403:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return I}});var n=t(5893),i=t(3804),a=t.n(i),r=t(1570),c=t(9341),l=t(9018),d=t(6703),o=t(7109);function u(){const[e,s]=(0,i.useState)(0),[t,n]=(0,i.useState)(""),[a,r]=(0,i.useState)(o.N.Steve);return(0,i.useEffect)((()=>{e<=0?n(""):(async()=>{const{hash:s,type:t}=await d.U2(`/skinlib/info/${e}`);n(`${blessing.base_url}/textures/${s}`),r(t)})()}),[e]),[{url:t,type:a},s]}var v=t(88),h=t(439),j=t(8848),p=t(5944),m=t(917),x=t(3291),g=t(6051),b=e=>{const{player:s}=e,t=e.selected&&m.iv`
      background: #efefef;
      .dark-mode & {
        background: var(--dark);
      }
    `;return(0,p.BX)("tr",Object.assign({css:[g.G,t],onClick:e.onClick},{children:[(0,p.tZ)("td",{children:s.pid},void 0),(0,p.BX)("td",{children:[(0,p.tZ)("span",{children:s.name},void 0),(0,p.tZ)(x.Z,{title:(0,v.t)("user.player.edit-pname"),onClick:()=>{e.onEditName(s)}},void 0)]},void 0),(0,p.BX)("td",Object.assign({className:"d-flex"},{children:[(0,p.tZ)("button",Object.assign({className:"btn btn-warning",onClick:e.onReset},{children:(0,v.t)("user.player.delete-texture")}),void 0),(0,p.tZ)("button",Object.assign({className:"btn btn-danger ml-2",onClick:()=>{e.onDelete(s)}},{children:(0,v.t)("user.player.delete-player")}),void 0)]}),void 0)]}),void 0)},f=t(574),y=t(1655);const N=f.Z.tr`
  height: 64px;
`,k=(0,f.Z)(y.ZP)`
  line-height: 2;
`;var O=()=>(0,n.jsx)(N,{children:(0,n.jsx)("td",Object.assign({colSpan:3},{children:(0,n.jsx)(k,{},void 0)}),void 0)},void 0),w=t(7196),C=t.n(w),S=t(9683),Z=t(6309);const A=f.Z.div`
  display: flex;
  justify-content: space-between;
  width: 80%;

  img {
    max-height: 64px;
    width: 64px;
  }
`;var P=e=>(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("h3",Object.assign({className:"card-title"},{children:(0,v.t)("general.texturePreview")}),void 0)}),void 0),(0,n.jsxs)("div",Object.assign({className:"card-body"},{children:[(0,n.jsxs)(A,Object.assign({className:"mb-5"},{children:[(0,n.jsx)("span",{children:(0,v.t)("general.skin")},void 0),e.skin?(0,n.jsx)("img",{src:e.skin,alt:(0,v.t)("general.skin")},void 0):(0,n.jsx)("span",{children:(0,v.t)("user.player.texture-empty")},void 0)]}),void 0),(0,n.jsxs)(A,Object.assign({className:"mt-5"},{children:[(0,n.jsx)("span",{children:(0,v.t)("general.cape")},void 0),e.cape?(0,n.jsx)("img",{src:e.cape,alt:(0,v.t)("general.cape")},void 0):(0,n.jsx)("span",{children:(0,v.t)("user.player.texture-empty")},void 0)]}),void 0)]}),void 0),(0,n.jsx)("div",Object.assign({className:"card-footer"},{children:e.children}),void 0)]}),void 0);const _=a().lazy((()=>Promise.all([t.e(308),t.e(617)]).then(t.bind(t,617))));var E=e=>{const[s,t]=(0,i.useState)(!0),r=(0,S.Z)("#previewer"),c=(0,n.jsx)("button",Object.assign({className:"btn btn-default",onClick:()=>t((e=>!e))},{children:s?(0,v.t)("user.switch2dPreview"):(0,v.t)("user.switch3dPreview")}),void 0),{skin:l,cape:d,isAlex:o}=e;return r&&C().createPortal(s?(0,n.jsx)(a().Suspense,Object.assign({fallback:(0,n.jsx)(Z.Z,{},void 0)},{children:(0,n.jsx)(_,Object.assign({skin:l,cape:d,isAlex:o},{children:c}),void 0)}),void 0):(0,n.jsx)(P,Object.assign({skin:l,cape:d},{children:c}),void 0),r)},B=t(2794),R=e=>{const[s,t]=(0,i.useState)(""),{score:a,cost:r,rule:c,length:l}=blessing.extra,o=a>=r;return(0,n.jsxs)(B.Z,Object.assign({show:e.show,title:(0,v.t)("user.player.add-player"),onConfirm:async()=>{const{code:t,message:n,data:i}=await d.v_(j.Z.user.player.add(),{name:s});0===t?(h.A.success(n),e.onAdd(i)):h.A.error(n)},onClose:()=>{t(""),e.onClose()}},{children:[(0,n.jsxs)("div",Object.assign({className:"form-group"},{children:[(0,n.jsx)("label",Object.assign({htmlFor:"new-player-name"},{children:(0,v.t)("general.player.player-name")}),void 0),(0,n.jsx)("input",{type:"text",className:"form-control",id:"new-player-name",value:s,onChange:e=>{t(e.target.value)}},void 0)]}),void 0),(0,n.jsx)("div",Object.assign({className:"callout callout-info"},{children:(0,n.jsxs)("ul",Object.assign({className:"m-0 p-0 pl-3"},{children:[(0,n.jsx)("li",{children:c},void 0),(0,n.jsx)("li",{children:l},void 0)]}),void 0)}),void 0),(0,n.jsxs)("div",Object.assign({className:"alert alert-"+(o?"success":"danger"),role:"alert"},{children:[(0,n.jsx)("i",{className:"icon fas fa-"+(o?"check":"times")},void 0),(0,n.jsxs)("span",Object.assign({className:"ml-1"},{children:[(0,v.t)("user.cur-score")," ",a]}),void 0)]}),void 0)]}),void 0)},$=e=>{const[s,t]=(0,i.useState)(!1),[a,r]=(0,i.useState)(!1);return(0,n.jsxs)(B.Z,Object.assign({show:e.show,title:(0,v.t)("user.chooseClearTexture"),onConfirm:()=>{e.onSubmit(s,a)},onClose:()=>{t(!1),r(!1),e.onClose()}},{children:[(0,n.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:s,onChange:e=>{t(e.target.checked)}},void 0),(0,v.t)("general.skin")]}),void 0),(0,n.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:a,onChange:e=>{r(e.target.checked)}},void 0),(0,v.t)("general.cape")]}),void 0)]}),void 0)},I=(0,r.w)((()=>{const[e,s]=(0,i.useState)([]),[t,a]=(0,i.useState)(!0),[r,p]=(0,i.useState)(0),[m,x]=u(),[g,f]=u(),[y,N]=(0,i.useState)(""),[k,w]=(0,i.useState)(!1),[C,S]=(0,i.useState)(!1),Z=(0,c.Z)("count");(0,l.Z)();const A=e=>{p(e.pid),x(e.tid_skin),f(e.tid_cape)};(0,i.useEffect)((()=>{(async()=>{a(!0);const e=await d.U2("/user/player/list");s(e),1===e.length&&A(e[0]),a(!1)})()}),[]);const P=async e=>{try{await(0,h.K)({title:(0,v.t)("user.deletePlayer"),text:(0,v.t)("user.deletePlayerNotice"),okButtonType:"danger"})}catch(e){return}const{code:t,message:n}=await d.IV(j.Z.user.player.delete(e.pid));if(0===t){h.A.success(n);const{pid:t}=e;s((e=>e.filter((e=>e.pid!==t))))}else h.A.error(n)},_=()=>S(!0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("input",{type:"text",className:"form-control",placeholder:(0,v.t)("user.typeToSearch"),onChange:e=>{N(e.target.value)}},void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:"card-body p-0 table-responsive"},{children:(0,n.jsxs)("table",Object.assign({className:"table table-hover"},{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",Object.assign({style:{width:"12%"}},{children:"PID"}),void 0),(0,n.jsx)("th",{children:(0,v.t)("general.player.player-name")},void 0),(0,n.jsx)("th",Object.assign({style:{width:"50%"}},{children:(0,v.t)("user.player.operation")}),void 0)]},void 0)},void 0),(0,n.jsx)("tbody",{children:t?new Array(Z).fill(null).map(((e,s)=>(0,n.jsx)(O,{},s))):0===e.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",Object.assign({className:"text-center",colSpan:3},{children:(0,v.t)("general.noResult")}),void 0)},void 0):e.filter((({name:e})=>e.includes(y))).map(((e,t)=>(0,n.jsx)(b,{player:e,selected:r===e.pid,onClick:()=>A(e),onEditName:()=>(async(e,t)=>{let n;try{const{value:s}=await(0,h.K)({mode:"prompt",text:(0,v.t)("user.changePlayerName"),input:e.name,validator:e=>{if(!e)return(0,v.t)("user.emptyPlayerName")}});n=s}catch(e){return}const{code:i,message:a}=await d.gz(j.Z.user.player.rename(e.pid),{name:n});0===i?(h.A.success(a),s((s=>(s[t]=Object.assign(Object.assign({},e),{name:n}),s.slice())))):h.A.error(a)})(e,t),onReset:_,onDelete:P},e.pid)))},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:"card-footer"},{children:(0,n.jsxs)("button",Object.assign({className:"btn btn-primary",onClick:()=>w(!0)},{children:[(0,n.jsx)("i",{className:"fas fa-plus mr-1"},void 0),(0,n.jsx)("span",{children:(0,v.t)("user.player.add-player")},void 0)]}),void 0)}),void 0)]}),void 0),(0,n.jsx)(E,{skin:m.url,cape:g.url,isAlex:m.type===o.N.Alex},void 0),(0,n.jsx)(R,{show:k,onAdd:e=>{s((s=>[...s,e]))},onClose:()=>w(!1)},void 0),(0,n.jsx)($,{show:C,onSubmit:async(e,t)=>{if(!e&&!t)return void h.A.warning((0,v.t)("user.noClearChoice"));const n=new URLSearchParams;e&&n.append("skin","true"),t&&n.append("cape","true");const{code:i,message:a}=await d.IV(`${j.Z.user.player.clear(r)}?${n.toString()}`);0===i?(h.A.success(a),e&&x(0),t&&f(0),s((s=>{const n=s.findIndex((e=>e.pid===r)),i=Object.assign({},s[n]);return e&&(i.tid_skin=0),t&&(i.tid_cape=0),s[n]=i,s.slice()}))):h.A.error(a)},onClose:()=>S(!1)},void 0)]},void 0)}))}}]);