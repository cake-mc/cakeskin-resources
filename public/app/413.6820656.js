(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[413],{9341:function(e,s,i){"use strict";i.d(s,{Z:function(){return n}});var a=i(3804);function n(e,s){const[i,n]=(0,a.useState)(s);return(0,a.useEffect)((()=>{n(blessing.extra[e])}),[]),i}},8413:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return T}});var a=i(5893),n=i(3804),d=i(1570),t=i(57),c=i(9341),r=i(9972),o=i(88),l=i(6703),m=i(7109),v=i(439),j=i(8848),h=i(9147),g=i(7894),x=i(574),u=i(550);const b=x.Z.div`
  width: 48%;
  margin: 7px;

  ${u.Qj(u.Uo.lg)} {
    width: 98%;
  }
`,p=x.Z.div`
  width: 70px;
  display: flex;
  justify-content: center;
  padding-top: ${e=>e.py?"22px":"0"};
`,N=x.Z.div`
  > div:not(:last-child) {
    ${u.Qj(u.Uo.sm)} {
      border-bottom: 1px solid rgba(0, 0, 0, 0.125);
    }
    ${u.tS(u.Uo.sm)} {
      border-right: 1px solid rgba(0, 0, 0, 0.125);
    }
  }
`;function f(e){switch(e){case m.P.Banned:return(0,o.t)("admin.banned");case m.P.Normal:return(0,o.t)("admin.normal");case m.P.Admin:return(0,o.t)("admin.admin");case m.P.SuperAdmin:return(0,o.t)("admin.superAdmin")}}function w(e){return e?(0,o.t)("admin.verified"):(0,o.t)("admin.unverified")}function O(e,s){return e.uid===s.uid||s.permission>e.permission}function k(e,s){return s.permission>e.permission}var y=e=>{const{user:s,currentUser:i}=e,n=O(s,i);return(0,a.jsxs)(b,Object.assign({className:"info-box"},{children:[(0,a.jsx)(p,Object.assign({py:!0},{children:(0,a.jsx)("img",{className:"bs-avatar",src:`${blessing.base_url}/avatar/user/${s.uid}`},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"info-box-content"},{children:[(0,a.jsxs)("div",Object.assign({className:"row"},{children:[(0,a.jsx)("div",Object.assign({className:"col-10"},{children:(0,a.jsx)("b",{children:s.nickname},void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:"col-2"},{children:n&&(0,a.jsxs)("div",Object.assign({className:"float-right dropdown"},{children:[(0,a.jsx)("a",Object.assign({className:"text-gray",href:"#","data-toggle":"dropdown","aria-expanded":"false"},{children:(0,a.jsx)("i",{className:"fas fa-cog"},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"dropdown-menu dropdown-menu-right"},{children:[(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onEmailChange},{children:[(0,a.jsx)("i",{className:"fas fa-at mr-2"},void 0),(0,o.t)("admin.changeEmail")]}),void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onNicknameChange},{children:[(0,a.jsx)("i",{className:"fas fa-signature mr-2"},void 0),(0,o.t)("admin.changeNickName")]}),void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onPasswordChange},{children:[(0,a.jsx)("i",{className:"fas fa-asterisk mr-2"},void 0),(0,o.t)("admin.changePassword")]}),void 0),(0,a.jsx)("div",{className:"dropdown-divider"},void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onScoreChange},{children:[(0,a.jsx)("i",{className:"fas fa-coins mr-2"},void 0),(0,o.t)("admin.changeScore")]}),void 0),k(s,i)&&(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onPermissionChange},{children:[(0,a.jsx)("i",{className:"fas fa-user-secret mr-2"},void 0),(0,o.t)("admin.changePermission")]}),void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onVerificationToggle},{children:[(0,a.jsx)("i",{className:"fas fa-user-check mr-2"},void 0),(0,o.t)("admin.toggleVerification")]}),void 0),(0,a.jsx)("div",{className:"dropdown-divider"},void 0),n&&s.uid!==i.uid&&(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item dropdown-item-danger",onClick:e.onDelete},{children:[(0,a.jsx)("i",{className:"fas fa-trash mr-2"},void 0),(0,o.t)("admin.deleteUser")]}),void 0)]}),void 0)]}),void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:["UID: ",s.uid]},void 0),(0,a.jsxs)("div",{children:[(0,o.t)("general.user.email"),": ",(0,a.jsx)("span",{children:s.email},void 0)]},void 0),(0,a.jsxs)(N,Object.assign({className:"row m-2 border-top border-bottom"},{children:[(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("general.user.score")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:s.score}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("admin.permission")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:f(s.permission)}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("admin.verification")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:w(s.verified)}),void 0)]}),void 0)]}),void 0),(0,a.jsx)("div",{children:(0,a.jsxs)("small",Object.assign({className:"text-gray"},{children:[(0,o.t)("general.user.register-at"),": ",s.register_at]}),void 0)},void 0)]},void 0)]}),void 0)]}),void 0)},C=i(1655);const P=(0,x.Z)(C.ZP)`
  width: ${e=>e.width};
`;var Z=()=>(0,a.jsxs)(b,Object.assign({className:"info-box"},{children:[(0,a.jsx)(p,{children:(0,a.jsx)(C.ZP,{circle:!0,height:50,width:50},void 0)},void 0),(0,a.jsxs)("div",Object.assign({className:"info-box-content"},{children:[(0,a.jsxs)("div",Object.assign({className:"row"},{children:[(0,a.jsx)("div",Object.assign({className:"col-10"},{children:(0,a.jsx)(C.ZP,{width:"140px"},void 0)}),void 0),(0,a.jsx)("div",{className:"col-2"},void 0)]}),void 0),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)(C.ZP,{width:"140px"},void 0)},void 0),(0,a.jsx)("div",{children:(0,a.jsx)(C.ZP,{width:"140px"},void 0)},void 0),(0,a.jsxs)(N,Object.assign({className:"row m-2 border-top border-bottom"},{children:[(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("general.user.score")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:(0,a.jsx)(P,{width:"30%"},void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("admin.permission")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:(0,a.jsx)(P,{width:"30%"},void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"col-sm-4 py-1 text-center"},{children:[(0,a.jsx)("b",Object.assign({className:"d-block"},{children:(0,o.t)("admin.verification")}),void 0),(0,a.jsx)("span",Object.assign({className:"d-block py-1"},{children:(0,a.jsx)(P,{width:"30%"},void 0)}),void 0)]}),void 0)]}),void 0),(0,a.jsx)("div",{children:(0,a.jsx)(C.ZP,{width:"180px"},void 0)},void 0)]},void 0)]}),void 0)]}),void 0),A=i(3291),S=e=>{const{user:s,currentUser:i}=e,n=O(s,i);return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:s.uid},void 0),(0,a.jsxs)("td",{children:[s.email,n&&(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(A.Z,{title:(0,o.t)("admin.changeEmail"),onClick:e.onEmailChange},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[s.nickname,n&&(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(A.Z,{title:(0,o.t)("admin.changeNickName"),onClick:e.onNicknameChange},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[s.score,n&&(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(A.Z,{title:(0,o.t)("admin.changeScore"),onClick:e.onScoreChange},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[f(s.permission),k(s,i)&&(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(A.Z,{title:(0,o.t)("admin.changePermission"),onClick:e.onPermissionChange},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[w(s.verified),n&&(0,a.jsx)("a",Object.assign({className:"ml-1",href:"#",title:(0,o.t)("admin.toggleVerification"),onClick:e.onVerificationToggle},{children:s.verified?(0,a.jsx)("i",{className:"fas fa-toggle-on"},void 0):(0,a.jsx)("i",{className:"fas fa-toggle-off"},void 0)}),void 0)]},void 0),(0,a.jsx)("td",{children:s.register_at},void 0),(0,a.jsxs)("td",{children:[(0,a.jsx)("button",Object.assign({className:"btn btn-default mr-2",disabled:!n,onClick:e.onPasswordChange},{children:(0,o.t)("admin.changePassword")}),void 0),(0,a.jsx)("button",Object.assign({className:"btn btn-danger",disabled:!n||s.uid===i.uid,onClick:e.onDelete},{children:(0,o.t)("admin.deleteUser")}),void 0)]},void 0)]},void 0)};const U=(0,x.Z)(C.ZP)`
  line-height: 2;
`;var E=()=>(0,a.jsx)("tr",{children:(0,a.jsx)("td",Object.assign({colSpan:8},{children:(0,a.jsx)(U,{},void 0)}),void 0)},void 0),T=(0,d.w)((()=>{const[e,s]=(0,t.x)([]),[i,d]=(0,n.useState)(1),[x,u]=(0,n.useState)(1),[b,p]=(0,n.useState)(!1),N=(0,r.Z)(),[f,w]=(0,n.useState)(!1),[O,k]=(0,n.useState)(""),C=(0,c.Z)("currentUser",{uid:0,permission:m.P.Admin});(0,n.useLayoutEffect)((()=>{N&&w(!0)}),[N]);const P=async()=>{p(!0);const{data:e,last_page:a}=await l.U2(j.Z.admin.users.list(),{q:O,page:i});s((()=>e)),u(a),p(!1)};(0,n.useEffect)((()=>{P()}),[i]);const A=e=>{w("table"===e.target.value)},U=async(e,i)=>{let a;try{const{value:s}=await(0,v.K)({mode:"prompt",text:(0,o.t)("admin.newUserEmail"),input:e.email,inputMode:"email",validator:e=>{if(!e)return(0,o.t)("auth.emptyEmail")}});a=s}catch(e){return}const{code:n,message:d}=await l.gz(j.Z.admin.users.email(e.uid),{email:a});0===n?(v.A.success(d),s((e=>{e[i].email=a}))):v.A.error(d)},T=async(e,i)=>{let a;try{const{value:s}=await(0,v.K)({mode:"prompt",text:(0,o.t)("admin.newUserNickname"),input:e.nickname,validator:e=>{if(!e)return(0,o.t)("auth.emptyNickname")}});a=s}catch(e){return}const{code:n,message:d}=await l.gz(j.Z.admin.users.nickname(e.uid),{nickname:a});0===n?(v.A.success(d),s((e=>{e[i].nickname=a}))):v.A.error(d)},_=async(e,i)=>{let a;try{const{value:s}=await(0,v.K)({mode:"prompt",text:(0,o.t)("admin.newScore"),input:e.score.toString(),inputMode:"numeric"});a=Number.parseInt(s)}catch(e){return}const{code:n,message:d}=await l.gz(j.Z.admin.users.score(e.uid),{score:a});0===n?(v.A.success(d),s((e=>{e[i].score=a}))):v.A.error(d)},D=async(e,i)=>{const a=[{text:(0,o.t)("admin.banned"),value:"-1"},{text:(0,o.t)("admin.normal"),value:"0"}];let n;C.permission>m.P.Admin&&a.push({text:(0,o.t)("admin.admin"),value:"1"});try{const{value:s}=await(0,v.K)({mode:"prompt",text:(0,o.t)("admin.newPermission"),input:e.permission.toString(),inputType:"radios",choices:a});n=Number.parseInt(s)}catch(e){return}const{code:d,message:t}=await l.gz(j.Z.admin.users.permission(e.uid),{permission:n});0===d?(v.A.success(t),s((e=>{e[i].permission=n}))):v.A.error(t)},V=async(e,i)=>{const{code:a,message:n}=await l.gz(j.Z.admin.users.verification(e.uid));0===a?(v.A.success(n),s((e=>{e[i].verified=!e[i].verified}))):v.A.error(n)},$=async e=>{let s;try{const{value:e}=await(0,v.K)({mode:"prompt",text:(0,o.t)("admin.newUserPassword"),inputType:"password",placeholder:(0,o.t)("admin.changePassword")});s=e}catch(e){return}const{code:i,message:a}=await l.gz(j.Z.admin.users.password(e.uid),{password:s});0===i?v.A.success(a):v.A.error(a)},z=async e=>{try{await(0,v.K)({text:(0,o.t)("admin.deleteUserNotice"),okButtonType:"danger"})}catch(e){return}const{code:i,message:a}=await l.IV(j.Z.admin.users.delete(e.uid));0===i?(v.A.success(a),s((s=>s.filter((({uid:s})=>s!==e.uid))))):v.A.error(a)};return(0,a.jsxs)("div",Object.assign({className:"card"},{children:[(0,a.jsxs)(g.Z,Object.assign({className:"card-header"},{children:[(0,a.jsxs)("form",Object.assign({className:"input-group",onSubmit:e=>{e.preventDefault(),P()}},{children:[(0,a.jsx)("input",{type:"text",inputMode:"search",className:"form-control",title:(0,o.t)("vendor.datatable.search"),value:O,onChange:e=>{k(e.target.value)}},void 0),(0,a.jsx)("div",Object.assign({className:"input-group-append"},{children:(0,a.jsx)("button",Object.assign({className:"btn btn-primary",type:"submit"},{children:(0,o.t)("vendor.datatable.search")}),void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"btn-group btn-group-toggle"},{children:[(0,a.jsxs)("label",Object.assign({className:"btn btn-secondary "+(f?"active":""),title:"Table Mode"},{children:[(0,a.jsx)("input",{type:"radio",value:"table",checked:f,onChange:A},void 0),(0,a.jsx)("i",{className:"fas fa-list"},void 0)]}),void 0),(0,a.jsxs)("label",Object.assign({className:"btn btn-secondary "+(f?"":"active"),title:"Card Mode"},{children:[(0,a.jsx)("input",{type:"radio",value:"card",checked:!f,onChange:A},void 0),(0,a.jsx)("i",{className:"fas fa-grip-vertical"},void 0)]}),void 0)]}),void 0)]}),void 0),0!==e.length||b?f?(0,a.jsx)("div",Object.assign({className:"card-body table-responsive p-0"},{children:(0,a.jsxs)("table",Object.assign({className:"table "+(b?"":"table-striped")},{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"UID"},void 0),(0,a.jsx)("th",{children:(0,o.t)("general.user.email")},void 0),(0,a.jsx)("th",{children:(0,o.t)("general.user.nickname")},void 0),(0,a.jsx)("th",{children:(0,o.t)("general.user.score")},void 0),(0,a.jsx)("th",{children:(0,o.t)("admin.permission")},void 0),(0,a.jsx)("th",{children:(0,o.t)("admin.verification")},void 0),(0,a.jsx)("th",{children:(0,o.t)("general.user.register-at")},void 0),(0,a.jsx)("th",{children:(0,o.t)("admin.operationsTitle")},void 0)]},void 0)},void 0),(0,a.jsx)("tbody",{children:b?new Array(10).fill(null).map(((e,s)=>(0,a.jsx)(E,{},s))):e.map(((e,s)=>(0,a.jsx)(S,{user:e,currentUser:C,onEmailChange:()=>U(e,s),onNicknameChange:()=>T(e,s),onScoreChange:()=>_(e,s),onPermissionChange:()=>D(e,s),onVerificationToggle:()=>V(e,s),onPasswordChange:()=>$(e),onDelete:()=>z(e)},e.uid)))},void 0)]}),void 0)}),void 0):(0,a.jsx)("div",Object.assign({className:"card-body d-flex flex-wrap"},{children:b?new Array(10).fill(null).map(((e,s)=>(0,a.jsx)(Z,{},s))):e.map(((e,s)=>(0,a.jsx)(y,{user:e,currentUser:C,onEmailChange:()=>U(e,s),onNicknameChange:()=>T(e,s),onScoreChange:()=>_(e,s),onPermissionChange:()=>D(e,s),onVerificationToggle:()=>V(e,s),onPasswordChange:()=>$(e),onDelete:()=>z(e)},e.uid)))}),void 0):(0,a.jsx)("div",Object.assign({className:"card-body text-center"},{children:(0,o.t)("general.noResult")}),void 0),(0,a.jsx)("div",Object.assign({className:"card-footer"},{children:(0,a.jsx)("div",Object.assign({className:"float-right"},{children:(0,a.jsx)(h.Z,{page:i,totalPages:x,onChange:d},void 0)}),void 0)}),void 0)]}),void 0)}))}}]);